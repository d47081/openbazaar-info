function urlify(a){return a.replace(/(https?:\/\/[^\s]+)/g,function(b){return'<a href="'+b+'">'+b+"</a>"})}function delay(c,a){var b=0;return function(){var e=this,d=arguments;clearTimeout(b);b=setTimeout(function(){c.apply(e,d)},a||0)}}var ModuleSearch={subscribe:{button:null,form:null,init:function(){ModuleSearch.subscribe.button=$("<i/>",{"data-fancybox":"","data-src":"#searchModuleSubscribeForm","class":"material-icons text-warning cursor-pointer subscribe-button"}).text("star_border");ModuleSearch.subscribe.form=$("<div/>",{id:"searchModuleSubscribeForm","class":"subscribe-form",style:"max-width: 600px"}).append($("<div/>",{"class":"inner"}));$(ModuleSearch.form.subscribe).append(ModuleSearch.subscribe.button);$(ModuleSearch.form.subscribe).append(ModuleSearch.subscribe.form);ModuleSearch.subscribe.load("","","")},load:function(c,b,a){$.ajax({url:"api/search/subscribe",type:"GET",data:{protocol:c,time:b,expired:a,s:ModuleSearch.input.s.getValue(),o:ModuleSearch.input.o.getValue(),t:ModuleSearch.input.t.getValue(),q:ModuleSearch.input.q.getValue(),m:ModuleSearch.input.m.getValue(),lf:ModuleSearch.input.lf.getValue(),lt:ModuleSearch.input.lt.getValue(),lc:ModuleSearch.input.lc.getValue(),ps:ModuleSearch.input.ps.getValue(),pr:ModuleSearch.input.pr.getValue(),id:ModuleSearch.input.id.getValue(),tor:ModuleSearch.input.tor.getValue(),},success:function(d){if(d.success){ModuleSearch.subscribe.button.attr("title",d.data.title);var f=$("<select/>",{name:"protocol","class":"custom-select custom-select-sm m-1",onchange:"ModuleSearch.subscribe.load($(this).val(), $('#searchModuleSubscribeForm input[name=time]').val(), $('#searchModuleSubscribeForm select[name=expired]').val())"});var e=$("<select/>",{name:"expired","class":"custom-select custom-select-sm m-1",onchange:"ModuleSearch.subscribe.load($('#searchModuleSubscribeForm select[name=protocol]').val(), $('#searchModuleSubscribeForm input[name=time]').val(), $(this).val())"});$(d.data.options.protocol).each(function(){f.append($("<option/>",{value:this.value,selected:this.selected,}).append(this.text))});$(d.data.options.expired).each(function(){e.append($("<option/>",{value:this.value,selected:this.selected}).append(this.text))});ModuleSearch.subscribe.form.find(".inner").html($("<p/>",{"class":"pb-2 border-bottom"}).append($("<i/>",{"class":"material-icons text-warning mr-2"}).append("star_border")).append($("<strong/>").append(d.data.title))).append($("<div/>",{"class":"form-inline mt-3 mb-3",}).append(f).append($("<input/>",{size:2,"class":"form-control form-control-sm m-1",type:"text",name:"time",value:d.data.options.time,})).append(e).append(d.data.error?$("<p/>",{"class":"text-danger m-1"}).append($("<small/>").append(d.data.error)):false)).append($("<p/>",{"class":"m-1"}).append(d.data.text)).append($("<small/>",{"class":"border rounded p-2 m-1"}).append($("<code/>").append(d.data.command))).append($("<p/>",{"class":"m-1"}).append(d.data.help)).append($("<small/>",{"class":"border rounded p-2 m-1"}).append($("<code/>").append($("<strong/>").append("#help"))));$("#searchModuleSubscribeForm input[name=time]").keyup(delay(function(g){ModuleSearch.subscribe.load($("#searchModuleSubscribeForm select[name=protocol]").val(),$(this).val(),$("#searchModuleSubscribeForm select[name=expired]").val())},1000))}},})},},form:{element:null,subscribe:null,},input:{q:{element:null,setValue:function(a){return ModuleSearch.input.q.element.val(a)},getValue:function(){return ModuleSearch.input.q.element.val()},},s:{element:null,setValue:function(a){return ModuleSearch.input.s.element.val(a)},getValue:function(){return ModuleSearch.input.s.element.val()},},o:{element:null,setValue:function(a){return ModuleSearch.input.o.element.val(a)},getValue:function(){return ModuleSearch.input.o.element.val()},},m:{element:null,setValue:function(a){return ModuleSearch.input.m.element.val(a)},getValue:function(){return ModuleSearch.input.m.element.val()},},tor:{element:null,setValue:function(a){return ModuleSearch.input.tor.element.val(a)},getValue:function(){return ModuleSearch.input.tor.element.val()},},t:{element:null,getValue:function(){return ModuleSearch.input.t.element.val()},},id:{element:null,values:null,addValue:function(a){if(-1===ModuleSearch.input.id.values.indexOf(a)){ModuleSearch.input.id.values.push(a)}ModuleSearch.update()},deleteValue:function(a){ModuleSearch.input.id.values.splice(ModuleSearch.input.id.values.indexOf(a),1);ModuleSearch.update()},getValue:function(){return ModuleSearch.input.id.values.join("|")},},lf:{element:null,values:null,flushValues:function(){ModuleSearch.input.lf.values=[];ModuleSearch.update()},addValue:function(a){if(-1===ModuleSearch.input.lf.values.indexOf(a)){ModuleSearch.input.lf.values.push(a)}ModuleSearch.update()},deleteValue:function(a){ModuleSearch.input.lf.values.splice(ModuleSearch.input.lf.values.indexOf(a),1);ModuleSearch.update()},getValue:function(){return ModuleSearch.input.lf.values.join("|")},},lt:{element:null,values:null,addValue:function(a){if(-1===ModuleSearch.input.lt.values.indexOf(a)){ModuleSearch.input.lt.values.push(a)}ModuleSearch.update()},deleteValue:function(a){ModuleSearch.input.lt.values.splice(ModuleSearch.input.lt.values.indexOf(a),1);ModuleSearch.update()},getValue:function(){return ModuleSearch.input.lt.values.join("|")},},lc:{element:null,values:null,addValue:function(a){if(-1===ModuleSearch.input.lc.values.indexOf(a)){ModuleSearch.input.lc.values.push(a)}ModuleSearch.update()},deleteValue:function(a){ModuleSearch.input.lc.values.splice(ModuleSearch.input.lc.values.indexOf(a),1);ModuleSearch.update()},getValue:function(){return ModuleSearch.input.lc.values.join("|")},},ps:{element:null,values:null,addValue:function(a){if(-1===ModuleSearch.input.ps.values.indexOf(a)){ModuleSearch.input.ps.values.push(a)}ModuleSearch.update()},deleteValue:function(a){ModuleSearch.input.ps.values.splice(ModuleSearch.input.ps.values.indexOf(a),1);ModuleSearch.update()},getValue:function(){return ModuleSearch.input.ps.values.join("|")},},pr:{element:null,values:null,addValue:function(a){if(-1===ModuleSearch.input.pr.values.indexOf(a)){ModuleSearch.input.pr.values.push(a)}ModuleSearch.update()},deleteValue:function(a){ModuleSearch.input.pr.values.splice(ModuleSearch.input.pr.values.indexOf(a),1);ModuleSearch.update()},getValue:function(){return ModuleSearch.input.pr.values.join("|")},},},submitFilterLf:function(b,a){if(b=="add"){ModuleSearch.input.lf.addValue(a)}else{if(b=="delete"){ModuleSearch.input.lf.deleteValue(a)}else{ModuleSearch.input.lf.flushValues()}}ModuleSearch.form.element.submit()},submitFilterLc:function(b,a){if(b=="add"){ModuleSearch.input.lc.addValue(a)}else{if(b=="delete"){ModuleSearch.input.lc.deleteValue(a)}else{ModuleSearch.input.lc.flushValues()}}ModuleSearch.form.element.submit()},submitFilterLt:function(b,a){if(b=="add"){ModuleSearch.input.lt.addValue(a)}else{if(b=="delete"){ModuleSearch.input.lt.deleteValue(a)}else{ModuleSearch.input.lt.flushValues()}}ModuleSearch.form.element.submit()},submitFilterPr:function(b,a){if(b=="add"){ModuleSearch.input.pr.addValue(a)}else{if(b=="delete"){ModuleSearch.input.pr.deleteValue(a)}else{ModuleSearch.input.pr.flushValues()}}ModuleSearch.form.element.submit()},submitFilterM:function(a){if(a=="true"){ModuleSearch.input.m.setValue("true")}else{if(a=="delete"){ModuleSearch.input.m.setValue("false")}else{ModuleSearch.input.m.setValue("")}}ModuleSearch.form.element.submit()},submitFilterTOR:function(a){if(a=="true"){ModuleSearch.input.tor.setValue("true")}else{if(a=="false"){ModuleSearch.input.tor.setValue("false")}else{ModuleSearch.input.tor.setValue("")}}ModuleSearch.form.element.submit()},submitSortOrder:function(a,b){ModuleSearch.input.s.setValue(a);ModuleSearch.input.o.setValue(b);ModuleSearch.form.element.submit()},update:function(){ModuleSearch.input.id.element.val(ModuleSearch.input.id.values.join("|"));ModuleSearch.input.lf.element.val(ModuleSearch.input.lf.values.join("|"));ModuleSearch.input.lc.element.val(ModuleSearch.input.lc.values.join("|"));ModuleSearch.input.lt.element.val(ModuleSearch.input.lt.values.join("|"));ModuleSearch.input.ps.element.val(ModuleSearch.input.ps.values.join("|"));ModuleSearch.input.pr.element.val(ModuleSearch.input.pr.values.join("|"))},init:function(f,i,l,c,n,g,p,j,e,a,b,h,d,k){ModuleSearch.form.element=$(f);ModuleSearch.form.subscribe=$(i);ModuleSearch.input.q.element=$(c);ModuleSearch.input.s.element=$(n);ModuleSearch.input.o.element=$(g);ModuleSearch.input.lf.element=$(p);ModuleSearch.input.lc.element=$(e);ModuleSearch.input.lt.element=$(j);ModuleSearch.input.ps.element=$(a);ModuleSearch.input.pr.element=$(b);ModuleSearch.input.id.element=$(d);ModuleSearch.input.m.element=$(h);ModuleSearch.input.t.element=$(l);ModuleSearch.input.tor.element=$(k);if(ModuleSearch.input.id.element.val()){ModuleSearch.input.id.values=ModuleSearch.input.id.element.val().split("|")}else{ModuleSearch.input.id.values=[]}if(ModuleSearch.input.lf.element.val()){ModuleSearch.input.lf.values=ModuleSearch.input.lf.element.val().split("|")}else{ModuleSearch.input.lf.values=[]}if(ModuleSearch.input.lc.element.val()){ModuleSearch.input.lc.values=ModuleSearch.input.lc.element.val().split("|")}else{ModuleSearch.input.lc.values=[]}if(ModuleSearch.input.lt.element.val()){ModuleSearch.input.lt.values=ModuleSearch.input.lt.element.val().split("|")}else{ModuleSearch.input.lt.values=[]}if(ModuleSearch.input.ps.element.val()){ModuleSearch.input.ps.values=ModuleSearch.input.ps.element.val().split("|")}else{ModuleSearch.input.ps.values=[]}if(ModuleSearch.input.pr.element.val()){ModuleSearch.input.pr.values=ModuleSearch.input.pr.element.val().split("|")}else{ModuleSearch.input.pr.values=[]}},};$(document).ready(function(){ModuleSearch.init('form[name="search"]',"form[name=search] .col-md","select[name=t]","input[name=q]","input[name=s]","input[name=o]",'input[name="lf"]','input[name="lt"]','input[name="lc"]','input[name="ps"]','input[name="pr"]','input[name="m"]','input[name="id"]','input[name="tor"]');ModuleSearch.form.element.on("submit",function(){$('form[name="search"] select[name="protocol"]').remove();$('form[name="search"] input[name="time"]').remove();$('form[name="search"] select[name="expired"]').remove();if(""==ModuleSearch.input.q.getValue()&&""==ModuleSearch.input.s.getValue()&&""==ModuleSearch.input.o.getValue()){ModuleSearch.input.s.setValue("added");ModuleSearch.input.o.setValue("desc")}if(""==ModuleSearch.input.s.element.val()){ModuleSearch.input.s.element.remove()}if(""==ModuleSearch.input.o.element.val()){ModuleSearch.input.o.element.remove()}if(""==ModuleSearch.input.lf.element.val()){ModuleSearch.input.lf.element.remove()}if(""==ModuleSearch.input.lt.element.val()){ModuleSearch.input.lt.element.remove()}if(""==ModuleSearch.input.lc.element.val()){ModuleSearch.input.lc.element.remove()}if(""==ModuleSearch.input.ps.element.val()){ModuleSearch.input.ps.element.remove()}if(""==ModuleSearch.input.pr.element.val()){ModuleSearch.input.pr.element.remove()}if(""==ModuleSearch.input.m.element.val()){ModuleSearch.input.m.element.remove()}if(""==ModuleSearch.input.id.element.val()){ModuleSearch.input.id.element.remove()}if(""==ModuleSearch.input.tor.element.val()){ModuleSearch.input.tor.element.remove()}});$(".nav-tabs a").click(function(a){a.preventDefault();$(this).tab("show")})});